!function(f,u){"use strict";u.module("mdFormConfirm",["ng"]).directive("form",["$timeout","$transitions","$mdDialog","$q",function(i,r,a,c){"ngInject";return{restrict:"E",scope:{name:"@name",ctrl:"@ctrl",obj:"@obj",nativeConfirm:"@nativeConfirm",formInit:"=formInit",formConfirmReject:"=formConfirmReject"},link:function(t,n,e){var o={enable:!0,backup:void 0,main:function(){e.ctrl&&e.obj&&o.addEventListener()},addEventListener:function(){i(o.setBackup.bind(o),700),r.onStart({},o.eventPrevent.bind(o)),t.$on("$destroy",o.clearEventListener.bind(o)),n.scope()[e.name].$isChanged=o.isModified.bind(o),n.scope()[e.name].$updateChanged=o.setBackup.bind(o),e.nativeConfirm&&o.enable&&(f.onbeforeunload=o.showNativeAlertConfirm.bind(o))},clearEventListener:function(){o.enable=!1,f.onbeforeunload=void 0},getData:function(){return n.scope()[e.ctrl][e.obj]},setBackup:function(){o.backup=u.copy(o.getData())},isModified:function(){if(o.enable)return!u.equals(o.getData(),o.backup)},showNativeAlertConfirm:function(){return o.isModified()},showPopupConfirm:function(){var e=c.defer();return a.show(a.confirm().title("Save changes").htmlContent("There are unsaved changes, would you like to continue?").cancel("CANCEL").ok("OK")).then(function(n){e.resolve(n)}).catch(function(n){e.reject(n),t.formConfirmReject&&t.formConfirmReject()}),e.promise},eventPrevent:function(){if(o.isModified())return o.showPopupConfirm(arguments)}};t.formInit=o.main.bind(o)}}}])}(window,window.angular);